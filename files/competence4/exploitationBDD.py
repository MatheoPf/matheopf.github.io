import math

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression


def Centreduire(T):
  Res = (T - np.mean(T, axis=0)) / np.std(T, axis=0)
  return Res


def DiagBatons(Colonne, i):
  m = np.min(Colonne)
  M = np.max(Colonne)
  print(f"{m=} {M=}")
  inter = np.linspace(m, M, 21)
  plt.figure()
  plt.title(CollegesDF.columns[i])
  plt.hist(Colonne, inter, histtype='bar', rwidth=0.7)
  plt.show()


CollegesDF = pd.read_csv("export.csv", sep=";")

# CollegesDF = pd.read_csv(
#     "C:\\Users\\Malo FAUCHET\\Documents\\Cours\\IUT Lannion\\S2\\SAE204\\Partie3\\export.csv", sep=";")

CollegesDF = CollegesDF.dropna()
CollegesAr = CollegesDF.to_numpy(dtype=np.float64)

CollegesAr_CR = Centreduire(CollegesAr)

print(f"{CollegesAr[:, 0]=}")
for i in range(CollegesAr.shape[1]):
  DiagBatons(CollegesAr[:, i], i)

coVarMat = np.cov(CollegesAr_CR, rowvar=False)

# for i in coVarMat:
#     for j in i:
#         print(f"{round(j, 4):>10}", end=" | ")
#     print('\n'+'-'*100)
# plus corele avec les note moyenne du brevet :
# nb_mentions_tb_g;nb_candidats_g;taux_de_reussite_g;note_a_l_ecrit_g;part_presents_3eme_ordinaire_g

Y = CollegesAr[:, 0]  # variable endog√®sne
X = CollegesAr[:, 1:]  # variable statistiques
Y = Centreduire(Y)
X = Centreduire(X)

linearRegression = LinearRegression()
linearRegression.fit(X, Y)
coefs = linearRegression.coef_
CorS = math.sqrt(linearRegression.score(X, Y))

print(f"{coefs=}\n{CorS=}")

linearRegression = LinearRegression()
linearRegression.fit(X, Y)
a = linearRegression.coef_
CorS = linearRegression.score(X, Y)
print(f"{a=}\n{math.sqrt(CorS)=}")
